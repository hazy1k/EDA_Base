# 3.电压采样电路分析

本项目采用分压电路实现高电压采集，设计可采集电压100V，当前配置采集电压为0-30V。

<img src="https://raw.githubusercontent.com/hazy1k/My-drawing-bed/main/2024/11/20-15-56-47-屏幕截图%202024-11-20%20155638.png" title="" alt="屏幕截图 2024-11-20 155638.png" width="613">

## 3.1 原理说明

依据串联分压原理，以30V DC为例，CW32的ADC 1.5V为基准参考电压时，要确保设计最大量程为30V，通过计算获得分压比：

![屏幕截图 2024-11-20 155802.png](https://raw.githubusercontent.com/hazy1k/My-drawing-bed/main/2024/11/20-15-58-09-屏幕截图%202024-11-20%20155802.png)

1. 电阻选择常用阻止同时留有测压余量，选择10K和220K搭配，实际量程约34V左右
2. 同理0-3V电路1:1分压比选择10K。

## 3.2 要点说明

### 3.2.1 电路保护

设计本项目的时候，额外在采样电路中增加了一个1N4148(D1等)作为钳位二极管。尽可能避免在学习和调试使用中由于接入不正确的电压，导致芯片引脚损坏。 二极管钳位是一种重要的电子电路设计技术，它的主要作用是通过限制电压的幅度来保护电路，避免信号过大或过小导致的损坏或故障。

钳位在电路中是指限制电压的意思，而二极管钳位特指利用二极管将电路中的某点电位进行限制的技术。

二极管钳位主要利用了二极管的单向导电性。当二极管的正极电压大于负极电压并且导通后，二极管两端的电压被限制在其管压降上，通常硅管的管压降约为0.7V。

钳位过程：通过二极管的钳位作用，将被钳位的电位强制拉向参考端，从而实现电位的限制。钳位并不改变原信号的波形，只是抬高或降低了信号的基准电位。

根据二极管连接方式的不同，钳位电路可分为正向钳位电路和负向钳位电路。本项目仅设计了正向钳位。

- 正向钳位电路：当二极管的正极接地时，为正向钳位电路。在正半周时，二极管截止；在负半周时，二极管导通，电容被充电至一定电压，使输出电压限制在一定范围内。
- 负向钳位电路：当二极管的负极接地时，为负向钳位电路。工作原理与正向钳位电路相反。

### 3.2.2 实现换挡

在本项目中，额外增加了一组电压采样电路，因此，我们可以探讨一下换挡对于提高测量精度的意义。万用表想要测的更准确，往往设置了多个档位。通过对不同档位的调整，获得被测点位在相应量程下的最佳的测量精度。

本项目实现此功能需要实现软硬件结合。当我们首先使用前文所讲的ADC_IN11通道测量30V以内电压时。若所测得电压在0~3V以内，则使用ADC_IN9通道测量。此时，由于分压比减小，测量精度大大提高。
